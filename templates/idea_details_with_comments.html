{% extends 'base.html' %}

{% block title %}Idea {{ idea.title }} Details{% endblock %}

{% block body %}
  <div class="container-fluid">

    <div class="row">
      <div class="col-12">
        <h1>{{ idea.title }}</h1>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        Created by: 
        <a href="/users/{{ idea.user_id }}/ideas">
          {{ idea.user.username }}
        </a>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <a href="{{ idea.link }}">
          {{ idea.link }}
        </a>
        <p>
          {{ idea.description }}
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        {% if session.get('user_id') %}
        <!-- <button class="btn btn-secondary btn-lg {{ 'active' if session.get('user_id') else '' }}" id="add-comment">Add your comment</button> -->
          % if session['user_id'] == idea.user_id %}
            <a class="btn btn-secondary btn-lg active" href="/ideas/{{ idea.idea_id }}" role="button">Edit your idea</a>
          {% endif %}
          {% if idea.user_vote == 1 %}                
            <a href="#" class='vote {{idea.idea_id}}'><i class="fas fa-check-circle" style="font-size: 1rem; color: green"></i></a>
          {% else %}
            <a href="#" class='vote {{idea.idea_id}}'><i class="fas fa-check-circle" style="font-size: 1rem; color: lightgray"></i></a>
          {% endif %}


          <button class="btn btn-secondary btn-lg active" id="add-comment">Add your comment</button>
          {
        {% else %}
          <button class="btn btn-secondary btn-lg" id="add-comment">Add your comment</button>
          <i class='far fa-comment-alt' style='font-size:36px'></i>
        {% endif %}
        <!-- <span class='total-votes {{idea.idea_id}}'>{{ idea.total_votes }}</span> votes  -->

      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <h2>Comments</h2>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <ul>
          {% for comment in comments %}
            <li>
              <p>
                <a href="/users/{{ comment.user_id }}/ideas">
                  {{ comment.user.username }}
                </a>
                <i>last modified: {{ comment.modified.strftime('%Y-%m-%d') }}</i>
                {% if session.get('user_id') and comment.user_id == session['user_id'] %}
                  <button type="button" class="btn btn-secondary btn-sm active edit-comment" id="{{ comment.comment_id}}">Edit</button>
                  <button type="button" class="btn btn-secondary btn-sm active delete-comment" id="{{ comment.comment_id}}">Delete</button>
                {% endif %}
              </p>
              <p style="white-space: pre-line">{{ comment.description }}</p>
              
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>

  </div>

  <script src="/static/js/handleComment.js"></script>
{% endblock %}
